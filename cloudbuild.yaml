steps:
- name: 'gcr.io/cloud-builders/go'
  entrypoint: 'bash'
  args:
    - '-c'
    - |
      echo "export GOPATH=/home/santhosh/gopath/go" >> $BASH_ENV
      echo "export PATH=/home/santhosh/go/bin:/home/santhosh/go/bin" >> $BASH_ENV
- name: 'gcr.io/cloud-builders/gcloud'
  args:
  - 'compute'
  - 'ssh'
  - 'santhosh@instance-1'
  - '--zone'
  - 'us-west4-b'
  - '--command'
  - |
    export PATH=$PATH:/home/santhosh/go/bin:/home/santhosh/go/bin
    export GOPATH='/home/santhosh/gopath:/google/gopath'
    cd /home/santhosh/todoappbysql
    go build main.go
    ./main

options:
  logging: 'CLOUD_LOGGING_ONLY'
